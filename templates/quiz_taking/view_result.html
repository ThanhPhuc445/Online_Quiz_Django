{% extends "base.html" %}
{% block title %}Kết quả: {{ result.quiz.title }}{% endblock %}

{% block content %}
<div class="text-center p-4 mb-4 bg-light rounded-3">
    <h1>Kết quả bài thi: {{ result.quiz.title }}</h1>
    <h2 class="display-4">Điểm số: <span class="text-primary fw-bold">{{ result.score }} / 100</span></h2>
    <p class="lead">Hoàn thành lúc: {{ result.completed_at|date:"H:i, d/m/Y" }}</p>
    
    <!-- === SỬA LỖI Ở ĐÂY: Thay 'home' bằng 'dashboard' === -->
    <a href="{% url 'dashboard' %}" class="btn btn-primary"><i class="bi bi-arrow-left-circle me-2"></i>Quay về Dashboard</a>
    
    <a href="{% url 'quiz:test_history' %}" class="btn btn-secondary"><i class="bi bi-clock-history me-2"></i>Xem lịch sử thi</a>
</div>

<h3 class="mb-3"><i class="bi bi-card-checklist me-2"></i>Xem lại bài làm chi tiết:</h3>

{% for item in detailed_answers %}
<div class="card mb-3">
    <div class="card-header">
        <strong>Câu hỏi {{ forloop.counter }}:</strong> {{ item.question_text }}
    </div>
    <ul class="list-group list-group-flush">
        {% for answer in item.all_answers %}
            <li class="list-group-item 
                {% if answer.id == item.correct_answer_id %}
                    list-group-item-success
                {% elif answer.id == item.student_answer_id %}
                    list-group-item-danger
                {% endif %}
            ">
                {{ answer.text }}
                
                {% if answer.id == item.correct_answer_id %}
                    <span class="badge bg-success float-end">Đáp án đúng</span>
                {% endif %}
                {% if answer.id == item.student_answer_id and answer.id != item.correct_answer_id %}
                    <span class="badge bg-danger float-end">Bạn đã chọn</span>
                {% endif %}
            </li>
        {% endfor %}
    </ul>
</div>
{% endfor %}
{% endblock %}