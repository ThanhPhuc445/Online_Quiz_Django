{% extends "base.html" %}
{% load static %}

{% block title %}Import câu hỏi từ Excel{% endblock %}

{% block content %}
<h1 class="page-title"><i class="bi bi-file-earmark-excel me-2"></i>Import câu hỏi từ Excel</h1>

<div class="row">
    <div class="col-lg-7">
        <div class="card">
            <div class="card-header">Hướng dẫn định dạng file</div>
            <div class="card-body">
                <p>File Excel của bạn phải là file `.xlsx` và có 8 cột theo đúng thứ tự sau:</p>
                <ol class="list-group list-group-numbered">
                    <li class="list-group-item"><strong>Cột A:</strong> Tên Môn học (VD: Lịch sử Đảng)</li>
                    <li class="list-group-item"><strong>Cột B:</strong> Nội dung câu hỏi</li>
                    <li class="list-group-item"><strong>Cột C:</strong> Độ khó (Giá trị phải là: <code>EASY</code>, <code>MEDIUM</code>, hoặc <code>HARD</code>)</li>
                    <li class="list-group-item"><strong>Cột D:</strong> Đáp án 1</li>
                    <li class="list-group-item"><strong>Cột E:</strong> Đáp án 2</li>
                    <li class="list-group-item"><strong>Cột F:</strong> Đáp án 3</li>
                    <li class="list-group-item"><strong>Cột G:</strong> Đáp án 4</li>
                    <li class="list-group-item"><strong>Cột H:</strong> Vị trí đáp án đúng (Là một số từ 1 đến 4)</li>
                </ol>
                <p class="mt-3 text-muted"><small>Lưu ý: Dòng đầu tiên trong file Excel sẽ được bỏ qua vì được coi là dòng tiêu đề.</small></p>
            </div>
            <div class="card-footer">
                <!-- Tạm thời để link trống, bạn cần tạo file mẫu và đặt vào static/files/ -->
                <a href="#" class="btn btn-link"><i class="bi bi-download me-2"></i>Tải file mẫu</a>
            </div>
        </div>
    </div>
    <div class="col-lg-5">
        <div class="card">
            <div class="card-header">Tải file lên</div>
            <div class="card-body">
                <form method="post" enctype="multipart/form-data">
                    {% csrf_token %}
                    <div class="mb-3">
                        <label for="excel_file" class="form-label">Chọn file .xlsx</label>
                        <input class="form-control" type="file" name="excel_file" id="excel_file" accept=".xlsx" required>
                    </div>
                    <div class="d-grid">
                        <button type="submit" class="btn btn-primary"><i class="bi bi-upload me-2"></i>Bắt đầu Import</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}